---
description: プロジェクト全体に共通する基本方針（常時適用）
alwaysApply: true
---

# Core Project Rules

このルールは、ショッピングリストMastraプロジェクト全体に常に適用される基本方針です。

## 言語・ランタイム前提

- TypeScript + ES2022 モジュールを前提とします。
- `package.json` では `"type": "module"` が設定されています。CommonJS への変更や混在は避けてください。
- `tsconfig.json` のターゲットやモジュール解決（特に `target`, `module`, `moduleResolution`）を壊さないようにします。
- Node.js は 22 以上を想定しています。異なるバージョンを前提としたコードパターンは導入しないでください。

## Mastra利用時の原則

- Mastraコード（`src/mastra/**`）を編集・追加する前に、以下のいずれかでAPI・型定義を確認してください。
  - `node_modules/@mastra/*/dist/docs/` にある埋め込みドキュメント
  - `https://mastra.ai/llms.txt` にある最新ドキュメント
- エージェント／ワークフロー／ツールの役割を明確に分けます。
  - **エージェント**: 意思決定とツール呼び出しを行う。
  - **ワークフロー**: 手続き的なステップを構成する。
  - **ツール**: 外部APIやDBなど具体的な処理を行う。

## AIアシスタントの基本姿勢

- 既存のエージェントやAPIの振る舞いを尊重し、互換性を壊さないようにします。
- 仕様が不明な箇所は推測で壊すのではなく、コメントやTODOを残す形で最小限の変更にとどめます。
- 動作確認が可能な場合は、変更後に最低限のテストや手動確認を行います。
  - 例: `npm run test:mastra` のような既存スクリプトがあれば、まずそれを利用します。

## セキュリティ・シークレット

- 環境変数やシークレット（DB接続情報、APIキーなど）は `.env` 系ファイルや環境設定で扱い、コードに直書きしないでください。
- `.env.local` やその他のシークレットファイルは Git にコミットしないでください。

## 将来のルール拡張について

- 役割ごとに詳細なルールファイルを追加することを想定しています。
  - 例: `mastra-agents.mdc`（Mastraエージェント向け）、`typescript-backend.mdc`（API/DB向け）、`react-frontend.mdc`（将来のUIレイヤ向け）など。
- 新しいルールファイルを追加する場合は、ここで定めた基本方針と矛盾しないようにしてください。

